doctype html
head
  meta(charset='UTF-8')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  meta(http-equiv='X-UA-Compatible' content='ie=edge')
  link(rel='stylesheet' href='/stylesheets/css_hoang/account.css')
  link(rel='stylesheet' href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css')
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  script(src="https://code.jquery.com/jquery-3.4.1.js"  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="  crossorigin="anonymous")
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script src="/javascripts/account/account.js"></script>
  <script src="https://js.braintreegateway.com/web/dropin/1.18.0/js/dropin.min.js"></script>
  title Tài khoản

#changepw.modal.fade
  .modal-dialog
    .modal-content
      // Modal Header
      .modal-header
        h2.modal-title.text-dark ĐỔI MẬT KHẨU
        button.close(type='button', data-dismiss='modal') ×
      // Modal body
      .modal-body
        .row
          .col-1
          .col-10
            form(method='POST' action='/account/'+account._id+'/changepwd')
              div.form-group
                label(for='family_name') Mật khẩu hiện tại:
                input#password.form-control(type='password' placeholder='●●●●●●●●' name='password_cur' required='true' )
              div.form-group                
                label(for='family_name') Mật khẩu:
                input#password.form-control(type='password' placeholder='●●●●●●●●' name='password_new' required='true' )
              div.form-group  
                label(for='family_name') Xác nhận mật khẩu:
                input#password_cfm.form-control(type='password' placeholder='●●●●●●●●' name='passwordnew_cfm' required='true' )
                br
                button.btn.btn-primary(type='submit' class='float-right') Xác nhận
          .col-1

#edit.modal.fade
  .modal-dialog
    .modal-content
      // Modal Header
      .modal-header
        h2.modal-title.text-dark THAY ĐỔI THÔNG TIN
        button.close(type='button', data-dismiss='modal') ×
      // Modal body
      .modal-body
        .row
          .col-1
          .col-10
            form(method='POST' action='/account/'+account._id+'/update')
              div.form-group
                label(for='fullname') Họ và tên:
                input#fullname.form-control(type='text' placeholder='Nguyễn Văn A' name='fullname' value=(undefined===account ? '' : account.fullname))
              div.form-group  
                label(for='family_name') Email:
                input#email.form-control(type='text' placeholder='nguyenvana@gmail.com' name='email' value=(undefined===account ? '' : account.email))
              div.form-group  
                label(for='family_name') Số điện thoại:
                input#phone.form-control(type='text' placeholder='0123456789' name='phone'  value=(undefined===account ? '' : account.phone))
              div.form-group  
                label(for='family_name') Địa chỉ:
                input#address.form-control(type='text' placeholder='Quận 9 - HCM' name='address' value=(undefined===account ? '' : account.address))
                br
                button.btn.btn-primary(type='submit' class='float-right') Xác nhận
          .col-1

#exchange.modal.fade
  .modal-dialog.modal-lg
    .modal-content
      // Modal Header
      .modal-header
        h2.modal-title.text-dark CHUYỂN ĐỔI CASH SANG GEM (IN-GAME)
        button.close(type='button', data-dismiss='modal') ×
      // Modal body
      .modal-body
        form(method='POST' action='/account/exchange')
          div.form-group
            label#balance(data=account.cash) CASH hiện tại: <strong>#{account.cash}</strong>
            hr
            .row
              .col-5
                h3#title
                p#contentex Vui lòng chọn mệnh giá tương ứng ở bên phải để thanh toán
                button#submitex.btn.btn-success(type='submit' class='float-right') Xác nhận
              .col
              .vl
              .col
              .col-6
                table.table.table-bordered.table-striped.table-hover
                  thead
                    tr
                      th(scope="col") Chọn
                      th(scope="col") CASH tiêu hao
                      th(scope="col") GEM nhận được
                  tbody
                    tr#rowex1
                      td
                        input(id="gem1" type="radio" name="amount" value="1") 
                      td 1
                      td 1
                    tr#rowex2
                      td
                        input(id="gem2" type="radio" name="amount" value="5") 
                      td 5
                      td 5
                    tr#rowex3
                      td
                        input(id="gem3" type="radio" name="amount" value="40") 
                      td 40
                      td 40
                    tr#rowex4
                      td
                        input(id="gem4" type="radio" name="amount" value="100") 
                      td 100
                      td 100
                    tr#rowex5
                      td
                        input(id="gem5" type="radio" name="amount" value="200") 
                      td 200
                      td 200
                    tr#rowex6
                      td
                        input(id="gem6" type="radio" name="amount" value="400") 
                      td 400
                      td 400
                    tr#rowex7
                      td
                        input(id="gem7" type="radio" name="amount" value="1000") 
                      td 1,000
                      td 1,000
                    tr#rowex8
                      td
                        input(id="gem8" type="radio" name="amount" value="2000") 
                      td 2,000
                      td 2,000

#recharge.modal.fade
  .modal-dialog.modal-xl
    .modal-content
      // Modal Header
      .modal-header
        h2.modal-title.text-dark NẠP CASH
        button.close(type='button', data-dismiss='modal') ×
      // Modal body
      .modal-body
        .row
          .col-2
            img#mcash.typerecharge-selected(src='/images/account/mcash.png' value='0')
          .vl
          .col-2
            img#paypal.typerecharge(src='/images/account/paypal.png' value='0')
          .vl
          .col-2  
            img#nganluong.typerecharge(src='/images/account/nganluong.png' value='0')
          .vl
          .col-2  
            img#braintree.typerecharge(src='/images/account/braintree.png' value='0')
        hr

        #rechargemcash.container-fluid
          form(method='POST' action='/account/recharge')
            div.form-group
              .row
                .col-5
                  h5.text-primary Điền thông tin thẻ M-Card
                  div#inputseri.form-group
                      label(for='seri') Số thẻ M-Card:
                      input.form-control(type='text' name='seri' placeholder='Số thẻ M-Card')
                  div#inputnumber.form-group
                      label(for='number') Mã nạp thẻ M-Card:
                      input.form-control(type='text' name='number' placeholder='Mã nạp thẻ M-Card')
                  button#submitrc.btn.btn-success(type='submit' class='float-right') Xác nhận
                .col
                .vl
                .col
                .col-6
                    h5.text-primary Thẻ M-Card
                    table.table.table-bordered.table-striped.table-hover
                      thead
                        tr.text-center
                          th(scope="col") Giá
                          th(scope="col") CASH nhận được
                      tbody
                        tr 
                          td 20,000 VND
                          td Cash x 20
                        tr
                          td 50,000 VND
                          td Cash x 50
                        tr
                          td 100,000 VND
                          td Cash x 100
                        tr
                          td 200,000 VND
                          td Cash x 200
                        tr
                          td 500,000 VND
                          td Cash x 500

        #rechargenganluong.container-fuild
          form#rechargenganluong(method='POST' action='/account/rechargenganluong')
            div.form-group
              input(type='hidden' name='price' value='')
              .row
                .col
                  h5#contentrc.text-primary Chọn mệnh giá tương ứng ở bên trái để thanh toán
                  #cartinfo
                    hr
                    .row
                      .col
                        label.float-left Sản phẩm được chọn
                      .col
                        label#product.float-right.font-weight-bold
                    hr
                    .row
                      .col
                        label.float-left Giá
                      .col
                        label#price.float-right.font-weight-bold 
                    hr
                    .row
                      .col
                        label.float-left Phương thức thanh toán
                      .col
                        label#method.float-right.font-weight-bold Ngân lượng
                    hr
                  button#processpaymentNganLuong.btn.btn-danger(type='button' class='float-right') Xử lý thanh toán
                .col-1
                .vl
                .col-5
                    h5#nameoftype.text-primary Thanh toán ngân lượng
                    table.table.table-bordered.table-striped.table-hover
                      thead
                        tr.text-center
                          th#choose(scope="col") Chọn
                          th(scope="col") Giá
                          th(scope="col") CASH nhận được
                      tbody
                        tr#rowrc1
                          td#cash1.text-center
                            input#productNganLuong1(type="radio" name="product" value="23") 
                          td 20.000 VNĐ
                          td Cash x 20 (tặng thêm 10)
                        tr#rowrc2
                          td#cash2.text-center
                            input#productNganLuong2(type="radio" name="product" value="230") 
                          td 50.000 VNĐ
                          td Cash x 50 (tặng thêm 25)
                        tr#rowrc3
                          td#cash3.text-center
                            input#productNganLuong3(type="radio" name="product" value="2300") 
                          td 100.000 VNĐ
                          td Cash x 100 (tặng thêm 50)
                        tr#rowrc4
                          td#cash4.text-center
                            input#productNganLuong4(type="radio" name="product" value="23000") 
                          td 200.000 VNĐ
                          td Cash x 200 (tặng thêm 100)
                        tr#rowrc5
                          td#cash5.text-center
                            input#productNganLuong5(type="radio" name="product" value="230000") 
                          td 500.000 VNĐ
                          td Cash x 500 (tặng thêm 250)

        #rechargepaypal.container-fuild
          form#rechargepaypal(method='POST' action='/account/rechargepaypal')
            div.form-group
              input(type='hidden' name='price' value='')
              .row
                .col
                  h5#contentrc.text-primary Vui lòng chọn mệnh giá tương ứng ở bên trái để thanh toán
                  #cartinfo
                    hr
                    .row
                      .col
                        label.float-left Sản phẩm được chọn
                      .col
                        label#product.float-right.font-weight-bold
                    hr
                    .row
                      .col
                        label.float-left Giá
                      .col
                        label#price.float-right.font-weight-bold 
                    hr
                    .row
                      .col
                        label.float-left Phương thức thanh toán
                      .col
                        label#method.float-right.font-weight-bold PayPal
                    hr
                  button#processpayment.btn.btn-danger(type='button' class='float-right') Xử lý thanh toán
                .col-1
                .vl
                .col-5
                    h5#nameoftype.text-primary PayPal
                    table.table.table-bordered.table-striped.table-hover
                      thead
                        tr.text-center
                          th#choose(scope="col") Chọn
                          th(scope="col") Giá
                          th(scope="col") CASH nhận được
                      tbody
                        tr#rowrc1
                          td#cash1.text-center
                            input#product1(type="radio" name="product" value="23") 
                          td 0.99 $
                          td Cash x 23 (tặng thêm 2)
                        tr#rowrc2
                          td#cash2.text-center
                            input#product2(type="radio" name="product" value="230") 
                          td 9.99 $
                          td Cash x 230 (tặng thêm 23)
                        tr#rowrc3
                          td#cash3.text-center
                            input#product3(type="radio" name="product" value="2300") 
                          td 99.99 $
                          td Cash x 2,300 (tặng thêm 230)
                        tr#rowrc4
                          td#cash4.text-center
                            input#product4(type="radio" name="product" value="23000") 
                          td 999.99 $
                          td Cash x 23,000 (tặng thêm 2,300)
                        tr#rowrc5
                          td#cash5.text-center
                            input#product5(type="radio" name="product" value="230000") 
                          td 9,999.99 $
                          td Cash x 230,000 (tặng thêm 23,000)  

        #rechargebraintree.container-fuild
          form#rechargebraintree(method='POST' action='/account/rechargebraintree')
            div.form-group
              input(type='hidden' name='price' value='')
              .row
                
                .col-5
                    h5#nameoftype.text-primary Braintree
                    table.table.table-bordered.table-striped.table-hover
                      thead
                        tr.text-center
                          th#choose(scope="col") Chọn
                          th(scope="col") Giá
                          th(scope="col") CASH nhận được
                      tbody
                        tr#rowrc1
                          td#cashBrainTree1.text-center
                            input#productBrainTree1(type="radio" name="product" value="23") 
                          td 0.99 $
                          td Cash x 23 (tặng thêm 2)
                        tr#rowrc2
                          td#cash2.text-center
                            input#productBrainTree2(type="radio" name="product" value="230") 
                          td 9.99 $
                          td Cash x 230 (tặng thêm 23)
                        tr#rowrc3
                          td#cash3.text-center
                            input#productBrainTree3(type="radio" name="product" value="2300") 
                          td 99.99 $
                          td Cash x 2,300 (tặng thêm 230)
                        tr#rowrc4
                          td#cash4.text-center
                            input#productBrainTree4(type="radio" name="product" value="23000") 
                          td 999.99 $
                          td Cash x 23,000 (tặng thêm 2,300)
                        tr#rowrc5
                          td#cash5.text-center
                            input#productBrainTree5(type="radio" name="product" value="230000") 
                          td 9,999.99 $
                          td Cash x 230,000 (tặng thêm 23,000)      
                .vl(style='margin-left: 30px')
                #dropin-wrapper(style='margin-left: 50px')
                  #checkout-message
                  #dropin-container
                  button#submit-button Submit payment
section#tab1
  .row
    .col
      //Quảng cáo here
    div(style='margin:0 0 5px 0; padding:0;width:200px;position:fixed; left:0; top:0;')
      a(href='https://vietadsgroup.vn' target='_blank')
        img(border='0' height='665' src='https://vietadsgroup.vn/Uploads/files/banner-quang-cao-banner.png' width='200')
    .col
      #aboutme.main
        .avatar
          a(href='#')
            img.pic(src='http://pngimg.com/uploads/pokeball/pokeball_PNG8.png' alt='')
        br
        .infor
          .left-field
            li Họ và tên:
            li Email:
            li Số điện thoại:
            li Tên tài khoản:
            li Cash:
            li Ngày đăng ký:
            
            button.btn.btn-primary.mt-2(type='button', data-toggle='modal', data-target='#edit')
              | Thay đổi
            
            button.btn.btn-info.mt-2(type='button', data-toggle='modal', data-target='#recharge')
              | Nạp CASH
          
          .right-field
            li #{account.fullname==undefined?'NULL':account.fullname}
            li #{account.email==undefined?'NULL':account.email}
            li #{account.phone==undefined?'NULL':account.phone}
            li #{account.username==undefined?'NULL':account.username}
            li #{account.cash==undefined?'NULL':account.cash}
            li #{account.createdate_formatted==undefined?'NULL':account.createdate_formatted}
            
            button.btn.btn-warning.mt-2(type='button', data-toggle='modal', data-target='#changepw')
              | Đổi mật khẩu
            
            button.btn.btn-success.mt-2(type='button', data-toggle='modal', data-target='#exchange')
              | Đổi CASH => GEM
          a.btn.btn-danger.mt-2(href="/ingame") 
            .display-4.font-weight-bold VÀO GAME
    .col
      //quảng cáo here
      div(style='margin:0 0 5px 0; padding:0;width:200px;position:fixed; right:0; top:0;')
        a(href='http://hocwebgiare.com/' target='_blank')
          img(border='0' height='665' src='http://hocwebgiare.com/images/right_banner.jpg' width='200')



if errors 
  for error in errors
      script. 
        alert('#{error.msg}')

if success
  script.
    alert('#{success}');

script.
  var button = document.querySelector('#submit-button');
  braintree.dropin.create({
  // Insert your tokenization key here
  authorization: 'sandbox_x63jvf6p_vvn2wqk72jbtn36f',
  container: '#dropin-container'
  }, function (createErr, instance) {
  button.addEventListener('click', function () {
  instance.requestPaymentMethod(function (requestPaymentMethodErr, payload) {
  // When the user clicks on the 'Submit payment' button this code will send the
  // encrypted payment information in a variable called a payment method nonce
  $.ajax({
  type: 'POST',
  url: '/checkout',
  data: {'paymentMethodNonce': payload.nonce}
  }).done(function(result) {
  // Tear down the Drop-in UI
  instance.teardown(function (teardownErr) {
  if (teardownErr) {
  console.error('Could not tear down Drop-in UI!');
  } else {
  console.info('Drop-in UI has been torn down!');
  // Remove the 'Submit payment' button
  $('#submit-button').remove();
  }
  });
  if (result.success) {
  $('#checkout-message').html('<h1>Success</h1><p>Your Drop-in UI is working! Check your <a href="https://sandbox.braintreegateway.com/login">sandbox Control Panel</a> for your test transactions.</p><p>Refresh to try another transaction.</p>');
  } else {
  console.log(result);
  $('#checkout-message').html('<h1>Error</h1><p>Check your console.</p>');
  }
  });
  });
  });
  });
    